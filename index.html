<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belgrano Norte — El Rojito</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --red: #C8102E;
            --red-dark: #8B0000;
            --red-light: #E8304A;
            --red-glow: rgba(200, 16, 46, 0.15);
            --cream: #FFF8F0;
            --warm: #FFF0E6;
            --paper: #FFFDF9;
            --text: #1a0a05;
            --muted: #7a5a50;
            --border: #e8d5cc;
            --stripe-a: #fff8f5;
            --stripe-b: #fff0e8;
            --green: #1a7a4a;
            --green-bg: #e8f5ee;
            --amber: #b85c00;
            --amber-bg: #fff3e0;
            --shadow: 0 2px 12px rgba(200, 16, 46, 0.08);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--cream);
            color: var(--text);
            min-height: 100vh;
        }

        /* ── HEADER ── */
        .header {
            background: var(--red);
            background-image: linear-gradient(135deg, var(--red-dark) 0%, var(--red) 50%, var(--red-light) 100%);
            color: white;
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 50;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .header-inner {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            padding: 0.8rem 1.5rem;
            max-width: 1100px;
            margin: 0 auto;
        }

        .lozenge {
            background: white;
            color: var(--red);
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.1rem;
            letter-spacing: 0.05em;
            padding: 0.25rem 0.7rem;
            border-radius: 6px;
            line-height: 1;
            white-space: nowrap;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .header-title {
            flex: 1;
        }

        .header-title h1 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.8rem;
            letter-spacing: 0.08em;
            line-height: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header-title p {
            font-size: 0.72rem;
            opacity: 0.8;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            font-family: 'DM Mono', monospace;
        }

        .clock-box {
            font-family: 'DM Mono', monospace;
            font-size: 1.5rem;
            font-weight: 500;
            background: rgba(0, 0, 0, 0.2);
            padding: 0.3rem 0.8rem;
            border-radius: 6px;
            letter-spacing: 0.08em;
            text-shadow: 0 0 12px rgba(255, 200, 200, 0.5);
        }

        /* ── CONTROLS ── */
        .controls {
            background: white;
            border-bottom: 2px solid var(--red);
            padding: 0.8rem 1.5rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
            max-width: 100%;
        }

        .ctrl-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .ctrl-label {
            font-size: 0.68rem;
            font-weight: 600;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--muted);
            font-family: 'DM Mono', monospace;
            white-space: nowrap;
        }

        .pill-group {
            display: flex;
            border: 1.5px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .pill {
            padding: 0.4rem 0.9rem;
            background: white;
            color: var(--muted);
            font-family: 'DM Sans', sans-serif;
            font-size: 0.85rem;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.15s;
            border-right: 1px solid var(--border);
            white-space: nowrap;
        }

        .pill:last-child {
            border-right: none;
        }

        .pill:hover {
            background: var(--warm);
            color: var(--red);
        }

        .pill.active {
            background: var(--red);
            color: white;
            font-weight: 600;
        }

        .station-selects {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            flex: 1;
            flex-wrap: wrap;
        }

        .station-selects select {
            background: var(--paper);
            border: 1.5px solid var(--border);
            color: var(--text);
            font-family: 'DM Sans', sans-serif;
            font-size: 0.88rem;
            padding: 0.4rem 0.7rem;
            border-radius: 8px;
            outline: none;
            cursor: pointer;
            transition: border-color 0.15s;
            min-width: 140px;
            flex: 1;
            max-width: 220px;
        }

        .station-selects select:focus {
            border-color: var(--red);
        }

        .arrow-icon {
            color: var(--red);
            font-size: 1.1rem;
            font-weight: 700;
        }

        /* ── NEXT TRAIN BANNER ── */
        .next-banner {
            max-width: 1100px;
            margin: 1rem auto 0;
            padding: 0 1.5rem;
        }

        .next-card {
            background: white;
            border-radius: 14px;
            border-left: 5px solid var(--red);
            box-shadow: var(--shadow), 0 0 0 1px var(--border);
            padding: 1rem 1.4rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            flex-wrap: wrap;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-8px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .next-pulse {
            width: 10px;
            height: 10px;
            background: var(--red);
            border-radius: 50%;
            animation: pulse 1.2s ease infinite;
            flex-shrink: 0;
        }

        @keyframes pulse {

            0%,
            100% {
                box-shadow: 0 0 0 0 rgba(200, 16, 46, 0.5);
            }

            50% {
                box-shadow: 0 0 0 8px rgba(200, 16, 46, 0);
            }
        }

        .next-info {
            flex: 1;
        }

        .next-label {
            font-size: 0.65rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--muted);
            font-family: 'DM Mono', monospace;
        }

        .next-time {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.4rem;
            color: var(--red);
            line-height: 1;
            letter-spacing: 0.05em;
        }

        .next-detail {
            font-size: 0.82rem;
            color: var(--muted);
            margin-top: 0.2rem;
        }

        .next-detail strong {
            color: var(--text);
        }

        .next-countdown {
            text-align: center;
            background: var(--red-glow);
            border-radius: 10px;
            padding: 0.6rem 1.2rem;
            border: 1px solid rgba(200, 16, 46, 0.2);
        }

        .next-countdown .cd-num {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2rem;
            color: var(--red);
            line-height: 1;
        }

        .next-countdown .cd-label {
            font-size: 0.65rem;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-family: 'DM Mono', monospace;
        }

        .next-tag {
            padding: 0.25rem 0.7rem;
            border-radius: 20px;
            font-size: 0.72rem;
            font-weight: 700;
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }

        .tag-local {
            background: var(--green-bg);
            color: var(--green);
        }

        .tag-expreso {
            background: #fff0e0;
            color: #b86000;
        }

        .tag-directo {
            background: #e8eaff;
            color: #3040b0;
        }

        /* ── MAIN CONTENT ── */
        .main {
            max-width: 1100px;
            margin: 0 auto;
            padding: 1rem 1.5rem 2rem;
        }

        .section-header {
            display: flex;
            align-items: baseline;
            gap: 0.8rem;
            margin: 1.2rem 0 0.7rem;
        }

        .section-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.3rem;
            letter-spacing: 0.1em;
            color: var(--red);
        }

        .section-count {
            font-family: 'DM Mono', monospace;
            font-size: 0.75rem;
            color: var(--muted);
        }

        /* ── TRAIN CARDS ── */
        .trains-grid {
            display: flex;
            flex-direction: column;
            gap: 0;
            border-radius: 12px;
            overflow: hidden;
            border: 1.5px solid var(--border);
            box-shadow: var(--shadow);
        }

        /* Station header row */
        .station-header {
            display: grid;
            background: #f0e8e4;
            border-bottom: 2px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 5;
        }

        .sh-cell {
            padding: 0.5rem 0.6rem;
            font-size: 0.62rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--muted);
            font-family: 'DM Mono', monospace;
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            line-height: 1.2;
        }

        .sh-cell:last-child {
            border-right: none;
        }

        .sh-cell.from-col {
            color: var(--red);
            font-weight: 700;
        }

        .sh-cell.to-col {
            color: var(--green);
            font-weight: 700;
        }

        /* Train row */
        .train-row {
            display: grid;
            border-bottom: 1px solid var(--border);
            transition: background 0.12s;
            cursor: default;
        }

        .train-row:last-child {
            border-bottom: none;
        }

        .train-row.even {
            background: var(--stripe-a);
        }

        .train-row.odd {
            background: var(--stripe-b);
        }

        .train-row:hover {
            background: #ffebe5 !important;
        }

        .train-row.is-next {
            background: #fff3f0 !important;
            box-shadow: inset 3px 0 0 var(--red);
        }

        .train-row.past {
            opacity: 0.42;
        }

        .cell {
            padding: 0.55rem 0.6rem;
            border-right: 1px solid rgba(200, 150, 130, 0.2);
            display: flex;
            align-items: center;
            min-height: 40px;
        }

        .cell:last-child {
            border-right: none;
        }

        /* Column color bands */
        .col-0 {
            background: rgba(200, 16, 46, 0.04);
        }

        .col-1 {
            background: rgba(180, 60, 0, 0.03);
        }

        .col-2 {
            background: rgba(160, 100, 0, 0.03);
        }

        .col-3 {
            background: rgba(140, 120, 0, 0.03);
        }

        .col-4 {
            background: rgba(120, 140, 0, 0.03);
        }

        .col-5 {
            background: rgba(80, 160, 0, 0.03);
        }

        .col-6 {
            background: rgba(40, 160, 40, 0.03);
        }

        .col-7 {
            background: rgba(0, 160, 80, 0.03);
        }

        .col-8 {
            background: rgba(0, 150, 120, 0.03);
        }

        .col-9 {
            background: rgba(0, 140, 160, 0.03);
        }

        .col-10 {
            background: rgba(0, 100, 200, 0.04);
        }

        .col-11 {
            background: rgba(40, 60, 200, 0.04);
        }

        .col-12 {
            background: rgba(80, 20, 200, 0.04);
        }

        .col-13 {
            background: rgba(120, 0, 180, 0.04);
        }

        .col-14 {
            background: rgba(160, 0, 140, 0.04);
        }

        .col-15 {
            background: rgba(200, 0, 100, 0.04);
        }

        /* Column headers match bands */
        .sh-col-0 {
            background: rgba(200, 16, 46, 0.08);
        }

        .sh-col-1 {
            background: rgba(180, 60, 0, 0.06);
        }

        .sh-col-2 {
            background: rgba(160, 100, 0, 0.06);
        }

        .sh-col-3 {
            background: rgba(140, 120, 0, 0.06);
        }

        .sh-col-4 {
            background: rgba(120, 140, 0, 0.06);
        }

        .sh-col-5 {
            background: rgba(80, 160, 0, 0.06);
        }

        .sh-col-6 {
            background: rgba(40, 160, 40, 0.06);
        }

        .sh-col-7 {
            background: rgba(0, 160, 80, 0.06);
        }

        .sh-col-8 {
            background: rgba(0, 150, 120, 0.06);
        }

        .sh-col-9 {
            background: rgba(0, 140, 160, 0.06);
        }

        .sh-col-10 {
            background: rgba(0, 100, 200, 0.08);
        }

        .sh-col-11 {
            background: rgba(40, 60, 200, 0.08);
        }

        .sh-col-12 {
            background: rgba(80, 20, 200, 0.08);
        }

        .sh-col-13 {
            background: rgba(120, 0, 180, 0.08);
        }

        .sh-col-14 {
            background: rgba(160, 0, 140, 0.08);
        }

        .sh-col-15 {
            background: rgba(200, 0, 100, 0.08);
        }

        /* Train number cell */
        .cell-num {
            font-family: 'DM Mono', monospace;
            font-size: 0.72rem;
            color: var(--muted);
            flex-direction: column;
            gap: 2px;
            align-items: flex-start;
        }

        .cell-num .train-n {
            font-weight: 500;
            color: var(--text);
            font-size: 0.75rem;
        }

        /* Time cell */
        .cell-time {
            font-family: 'DM Mono', monospace;
            font-size: 0.88rem;
            font-weight: 500;
            color: var(--text);
        }

        .cell-time.from-time {
            color: var(--red);
            font-weight: 700;
            font-size: 0.95rem;
        }

        .cell-time.to-time {
            color: var(--green);
            font-weight: 700;
            font-size: 0.95rem;
        }

        .cell-time.next-time {
            color: var(--red);
            text-shadow: 0 0 8px rgba(200, 16, 46, 0.3);
        }

        .cell-empty {
            color: #d0c0ba;
            font-size: 0.7rem;
            font-family: 'DM Mono', monospace;
        }

        /* no-stop dot */
        .no-stop {
            color: #ddd;
            font-size: 1rem;
        }

        .no-results {
            padding: 3rem;
            text-align: center;
            font-family: 'DM Mono', monospace;
            font-size: 0.8rem;
            color: var(--muted);
            letter-spacing: 0.1em;
        }

        @media (max-width: 600px) {
            .header-inner {
                padding: 0.7rem 1rem;
            }

            .controls {
                padding: 0.7rem 1rem;
            }

            .next-banner,
            .main {
                padding-left: 1rem;
                padding-right: 1rem;
            }

            .clock-box {
                font-size: 1.1rem;
            }

            .header-title h1 {
                font-size: 1.4rem;
            }

            .station-selects select {
                max-width: 100%;
            }
        }
    </style>
</head>

<body>

    <header class="header">
        <div class="header-inner">
            <div class="lozenge">FC Belgrano Norte</div>
            <div class="header-title">
                <h1>El Rojito</h1>
                <p>Horario N°20 · Vigente desde 22/10/2024</p>
            </div>
            <div class="clock-box" id="clock">--:--:--</div>
        </div>
    </header>

    <div class="controls">
        <div class="ctrl-group">
            <span class="ctrl-label">Dirección</span>
            <div class="pill-group">
                <button class="pill active" id="btn-vr" onclick="setDir('vr')">→ Villa Rosa</button>
                <button class="pill" id="btn-ret" onclick="setDir('ret')">→ Retiro</button>
            </div>
        </div>

        <div class="ctrl-group">
            <span class="ctrl-label">Día</span>
            <div class="pill-group">
                <button class="pill active" id="btn-lv" onclick="setDay('lv')">Lun–Vie</button>
                <button class="pill" id="btn-sab" onclick="setDay('sab')">Sábado</button>
                <button class="pill" id="btn-dom" onclick="setDay('dom')">Dom/Fer</button>
            </div>
        </div>

        <div class="ctrl-group station-selects">
            <span class="ctrl-label">Desde</span>
            <select id="selFrom" onchange="render()"></select>
            <span class="arrow-icon">→</span>
            <select id="selTo" onchange="render()"></select>
        </div>
    </div>

    <div class="next-banner" id="nextBanner"></div>

    <div class="main">
        <div class="section-header">
            <span class="section-title" id="sectionTitle">Partidas hacia Villa Rosa</span>
            <span class="section-count" id="sectionCount"></span>
        </div>
        <div class="trains-grid" id="grid"></div>
    </div>

    <script>
        // ══════════════════════════════════════
        // BELGRANO NORTE — HORARIO N°20
        // Stations Retiro → Villa Rosa
        // ══════════════════════════════════════
        const STA = [
            "Retiro", "Saldías", "Cd. Universitaria", "A. del Valle", "M. Padilla",
            "Florida", "Munro", "Carapachay", "V. Adelina", "Boulogne",
            "Don Torcuato", "A. Sourdeaux", "Cd. Villa de Mayo", "Cd. Los Polvorines",
            "Cd. Ing. P. Nogués", "Cd. Grand Bourg", "Tierras Altas", "Cd. Tortuguitas",
            "M. Alberti", "Del Viso", "C. Grierson", "Villa Rosa"
        ];

        // A train is LOCAL if it stops at Grand Bourg (index 15) — el ramal local llega hasta ahí
        // EXPRESO if skips intermediate stops
        // We detect: if it reaches Villa Rosa = full run; if stops at Grand Bourg area = local
        // Simple heuristic: trains with null after index ~14 = short-run

        // Lun–Vie → Villa Rosa
        const LV_VR = [
            [3001, "00:20", "00:26", "00:32", "00:37", "00:41", "00:44", "00:47", "00:50", "00:53", "00:57", null, null, null, null, null, null, null, null, null, null, null, null],
            [3003, "02:50", "02:57", "03:01", "03:05", "03:07", "03:10", "03:14", "03:18", "03:22", "03:26", "03:29", "03:33", "03:37", "03:43", null, null, null, null, null, null, null, null],
            [3005, "03:30", "03:37", "03:41", "03:45", "03:47", "03:50", "03:54", "03:58", "04:02", "04:06", "04:09", "04:13", "04:17", "04:23", null, null, null, null, null, null, null, null],
            [3007, "04:08", "04:15", "04:19", "04:23", "04:25", "04:28", "04:32", "04:36", "04:40", "04:44", "04:47", "04:51", "04:55", "05:01", null, null, null, null, null, null, null, null],
            [3009, "04:45", "04:52", "04:56", "05:00", "05:02", "05:05", "05:09", "05:13", "05:17", "05:21", "05:24", "05:28", "05:32", "05:38", null, null, null, null, null, null, null, null],
            [3011, "04:46", "04:52", "04:58", "05:03", "05:07", "05:10", "05:13", "05:16", "05:19", "05:23", "05:30", "05:34", "05:38", "05:40", "05:43", "05:47", "05:51", "05:55", "05:59", "06:02", "06:06", "06:10", "06:16"],
            [3013, "05:13", "05:19", "05:25", "05:30", "05:34", "05:37", "05:40", "05:43", "05:46", "05:50", "05:57", "06:01", "06:05", "06:07", "06:10", "06:14", "06:18", "06:22", "06:26", "06:29", "06:33", "06:37", "06:43"],
            [3015, "05:39", "05:45", "05:51", "05:56", "06:00", "06:03", "06:06", "06:09", "06:12", "06:16", "06:23", "06:27", "06:31", "06:33", "06:36", "06:40", "06:44", "06:48", "06:52", "06:55", "06:59", "07:03", "07:09"],
            [3017, "06:05", "06:11", "06:17", "06:22", "06:26", "06:29", "06:32", "06:35", "06:38", "06:42", "06:49", "06:53", "06:57", "06:59", "07:02", "07:06", "07:10", "07:14", "07:18", "07:21", "07:25", "07:29", "07:35"],
            [3019, "06:15", "06:21", "06:27", "06:32", "06:36", "06:39", "06:42", "06:45", "06:48", "06:52", "06:59", "07:03", "07:07", "07:09", "07:12", "07:16", "07:20", null, null, null, null, null, null],
            [3021, "06:28", "06:34", "06:40", "06:45", "06:49", "06:52", "06:55", "06:58", "07:01", "07:05", "07:12", "07:16", "07:20", "07:22", "07:25", "07:29", "07:33", "07:37", "07:41", "07:44", "07:48", "07:52", "07:58"],
            [3023, "06:41", "06:47", "06:53", "06:58", "07:02", "07:05", "07:08", "07:11", "07:14", "07:18", "07:25", "07:29", "07:33", "07:35", "07:38", "07:42", "07:46", "07:50", "07:54", "07:57", "08:01", "08:05", "08:11"],
            [3025, "06:55", "07:01", "07:07", "07:12", "07:16", "07:19", "07:22", "07:25", "07:28", "07:32", "07:39", "07:43", "07:47", "07:49", "07:52", "07:56", "08:00", null, null, null, null, null, null],
            [3027, "07:10", "07:16", "07:22", "07:27", "07:31", "07:34", "07:37", "07:40", "07:43", "07:47", "07:54", "07:58", "08:02", "08:04", "08:07", "08:11", "08:15", "08:19", "08:23", "08:26", "08:30", "08:34", "08:40"],
            [3029, "07:25", "07:31", "07:37", "07:42", "07:46", "07:49", "07:52", "07:55", "07:58", "08:02", "08:09", "08:13", "08:17", "08:19", "08:22", "08:26", "08:30", "08:34", "08:38", "08:41", "08:45", "08:49", "08:55"],
            [3031, "07:40", "07:46", "07:52", "07:57", "08:01", "08:04", "08:07", "08:10", "08:13", "08:17", "08:24", "08:28", "08:32", "08:34", "08:37", "08:41", "08:45", null, null, null, null, null, null],
            [3033, "07:55", "08:01", "08:07", "08:12", "08:16", "08:19", "08:22", "08:25", "08:28", "08:32", "08:39", "08:43", "08:47", "08:49", "08:52", "08:56", "09:00", "09:04", "09:08", "09:11", "09:15", "09:19", "09:25"],
            [3035, "08:10", "08:16", "08:22", "08:27", "08:31", "08:34", "08:37", "08:40", "08:43", "08:47", "08:54", "08:58", "09:02", "09:04", "09:07", "09:11", "09:15", "09:19", "09:23", "09:26", "09:30", "09:34", "09:40"],
            [3037, "08:25", "08:31", "08:37", "08:42", "08:46", "08:49", "08:52", "08:55", "08:58", "09:02", "09:09", "09:13", "09:17", "09:19", "09:22", "09:26", "09:30", null, null, null, null, null, null],
            [3039, "08:40", "08:46", "08:52", "08:57", "09:01", "09:04", "09:07", "09:10", "09:13", "09:17", "09:24", "09:28", "09:32", "09:34", "09:37", "09:41", "09:45", "09:49", "09:53", "09:56", "10:00", "10:04", "10:10"],
            [3041, "08:55", "09:01", "09:07", "09:12", "09:16", "09:19", "09:22", "09:25", "09:28", "09:32", "09:39", "09:43", "09:47", "09:49", "09:52", "09:56", "10:00", "10:04", "10:08", "10:11", "10:15", "10:19", "10:25"],
            [3043, "09:10", "09:16", "09:22", "09:27", "09:31", "09:34", "09:37", "09:40", "09:43", "09:47", "09:54", "09:58", "10:02", "10:04", "10:07", "10:11", "10:15", null, null, null, null, null, null],
            [3045, "09:25", "09:31", "09:37", "09:42", "09:46", "09:49", "09:52", "09:55", "09:58", "10:02", "10:09", "10:13", "10:17", "10:19", "10:22", "10:26", "10:30", "10:34", "10:38", "10:41", "10:45", "10:49", "10:55"],
            [3047, "09:40", "09:46", "09:52", "09:57", "10:01", "10:04", "10:07", "10:10", "10:13", "10:17", "10:24", "10:28", "10:32", "10:34", "10:37", "10:41", "10:45", "10:49", "10:53", "10:56", "11:00", "11:04", "11:10"],
            [3049, "09:55", "10:01", "10:07", "10:12", "10:16", "10:19", "10:22", "10:25", "10:28", "10:32", "10:39", "10:43", "10:47", "10:49", "10:52", "10:56", "11:00", null, null, null, null, null, null],
            [3051, "10:10", "10:16", "10:22", "10:27", "10:31", "10:34", "10:37", "10:40", "10:43", "10:47", "10:54", "10:58", "11:02", "11:04", "11:07", "11:11", "11:15", "11:19", "11:23", "11:26", "11:30", "11:34", "11:40"],
            [3053, "10:25", "10:31", "10:37", "10:42", "10:46", "10:49", "10:52", "10:55", "10:58", "11:02", "11:09", "11:13", "11:17", "11:19", "11:22", "11:26", "11:30", "11:34", "11:38", "11:41", "11:45", "11:49", "11:55"],
            [3055, "10:40", "10:46", "10:52", "10:57", "11:01", "11:04", "11:07", "11:10", "11:13", "11:17", "11:24", "11:28", "11:32", "11:34", "11:37", "11:41", "11:45", null, null, null, null, null, null],
            [3057, "10:55", "11:01", "11:07", "11:12", "11:16", "11:19", "11:22", "11:25", "11:28", "11:32", "11:39", "11:43", "11:47", "11:49", "11:52", "11:56", "12:00", "12:04", "12:08", "12:11", "12:15", "12:19", "12:25"],
            [3059, "11:10", "11:16", "11:22", "11:27", "11:31", "11:34", "11:37", "11:40", "11:43", "11:47", "11:54", "11:58", "12:02", "12:04", "12:07", "12:11", "12:15", "12:19", "12:23", "12:26", "12:30", "12:34", "12:40"],
            [3061, "11:25", "11:31", "11:37", "11:42", "11:46", "11:49", "11:52", "11:55", "11:58", "12:02", "12:09", "12:13", "12:17", "12:19", "12:22", "12:26", "12:30", null, null, null, null, null, null],
            [3063, "11:40", "11:46", "11:52", "11:57", "12:01", "12:04", "12:07", "12:10", "12:13", "12:17", "12:24", "12:28", "12:32", "12:34", "12:37", "12:41", "12:45", "12:49", "12:53", "12:56", "13:00", "13:04", "13:10"],
            [3065, "11:55", "12:01", "12:07", "12:12", "12:16", "12:19", "12:22", "12:25", "12:28", "12:32", "12:39", "12:43", "12:47", "12:49", "12:52", "12:56", "13:00", "13:04", "13:08", "13:11", "13:15", "13:19", "13:25"],
            [3067, "12:10", "12:16", "12:22", "12:27", "12:31", "12:34", "12:37", "12:40", "12:43", "12:47", "12:54", "12:58", "13:02", "13:04", "13:07", "13:11", "13:15", null, null, null, null, null, null],
            [3069, "12:25", "12:31", "12:37", "12:42", "12:46", "12:49", "12:52", "12:55", "12:58", "13:02", "13:09", "13:13", "13:17", "13:19", "13:22", "13:26", "13:30", "13:34", "13:38", "13:41", "13:45", "13:49", "13:55"],
            [3071, "12:40", "12:46", "12:52", "12:57", "13:01", "13:04", "13:07", "13:10", "13:13", "13:17", "13:24", "13:28", "13:32", "13:34", "13:37", "13:41", "13:45", "13:49", "13:53", "13:56", "14:00", "14:04", "14:10"],
            [3073, "13:00", "13:06", "13:12", "13:17", "13:21", "13:24", "13:27", "13:30", "13:33", "13:37", "13:44", "13:48", "13:52", "13:54", "13:57", "14:01", "14:05", null, null, null, null, null, null],
            [3075, "13:10", "13:16", "13:22", "13:27", "13:31", "13:34", "13:37", "13:40", "13:43", "13:47", "13:54", "13:58", "14:02", "14:04", "14:07", "14:11", "14:15", "14:19", "14:23", "14:26", "14:30", "14:34", "14:40"],
            [3077, "13:25", "13:31", "13:37", "13:42", "13:46", "13:49", "13:52", "13:55", "13:58", "14:02", "14:09", "14:13", "14:17", "14:19", "14:22", "14:26", "14:30", "14:34", "14:38", "14:41", "14:45", "14:49", "14:55"],
            [3079, "13:40", "13:46", "13:52", "13:57", "14:01", "14:04", "14:07", "14:10", "14:13", "14:17", "14:24", "14:28", "14:32", "14:34", "14:37", "14:41", "14:45", null, null, null, null, null, null],
            [3081, "13:55", "14:01", "14:07", "14:12", "14:16", "14:19", "14:22", "14:25", "14:28", "14:32", "14:39", "14:43", "14:47", "14:49", "14:52", "14:56", "15:00", "15:04", "15:08", "15:11", "15:15", "15:19", "15:25"],
            [3083, "14:10", "14:16", "14:22", "14:27", "14:31", "14:34", "14:37", "14:40", "14:43", "14:47", "14:54", "14:58", "15:02", "15:04", "15:07", "15:11", "15:15", "15:19", "15:23", "15:26", "15:30", "15:34", "15:40"],
            [3085, "14:25", "14:31", "14:37", "14:42", "14:46", "14:49", "14:52", "14:55", "14:58", "15:02", "15:09", "15:13", "15:17", "15:19", "15:22", "15:26", "15:30", null, null, null, null, null, null],
            [3087, "14:40", "14:46", "14:52", "14:57", "15:01", "15:04", "15:07", "15:10", "15:13", "15:17", "15:24", "15:28", "15:32", "15:34", "15:37", "15:41", "15:45", "15:49", "15:53", "15:56", "16:00", "16:04", "16:10"],
            [3089, "14:55", "15:01", "15:07", "15:12", "15:16", "15:19", "15:22", "15:25", "15:28", "15:32", "15:39", "15:43", "15:47", "15:49", "15:52", "15:56", "16:00", "16:04", "16:08", "16:11", "16:15", "16:19", "16:25"],
            [3091, "15:10", "15:16", "15:22", "15:27", "15:31", "15:34", "15:37", "15:40", "15:43", "15:47", "15:54", "15:58", "16:02", "16:04", "16:07", "16:11", "16:15", null, null, null, null, null, null],
            [3093, "15:24", "15:30", "15:36", "15:41", "15:45", "15:48", "15:51", "15:54", "15:57", "16:01", "16:08", "16:12", "16:16", "16:18", "16:21", "16:25", "16:29", "16:33", "16:37", "16:40", "16:44", "16:48", "16:54"],
            [3095, "15:37", "15:43", "15:49", "15:54", "15:58", "16:01", "16:04", "16:07", "16:10", "16:14", "16:21", "16:25", "16:29", "16:31", "16:34", "16:38", "16:42", "16:46", "16:50", "16:53", "16:57", "17:01", "17:07"],
            [3097, "15:50", "15:56", "16:02", "16:07", "16:11", "16:14", "16:17", "16:20", "16:23", "16:27", "16:34", "16:38", "16:42", "16:44", "16:47", "16:51", "16:55", null, null, null, null, null, null],
            [3099, "16:03", "16:09", "16:15", "16:20", "16:24", "16:27", "16:30", "16:33", "16:36", "16:40", "16:47", "16:51", "16:55", "16:57", "17:00", "17:04", "17:08", "17:12", "17:16", "17:19", "17:23", "17:27", "17:33"],
            [3101, "16:16", "16:22", "16:28", "16:33", "16:37", "16:40", "16:43", "16:46", "16:49", "16:53", "17:00", "17:04", "17:08", "17:10", "17:13", "17:17", "17:21", "17:25", "17:29", "17:32", "17:36", "17:40", "17:46"],
            [3103, "16:29", "16:35", "16:41", "16:46", "16:50", "16:53", "16:56", "16:59", "17:02", "17:06", "17:13", "17:17", "17:21", "17:23", "17:26", "17:30", "17:34", null, null, null, null, null, null],
            [3105, "16:42", "16:48", "16:54", "16:59", "17:03", "17:06", "17:09", "17:12", "17:15", "17:19", "17:26", "17:30", "17:34", "17:36", "17:39", "17:43", "17:47", "17:51", "17:55", "17:58", "18:02", "18:06", "18:12"],
            [3107, "16:55", "17:01", "17:07", "17:12", "17:16", "17:19", "17:22", "17:25", "17:28", "17:32", "17:39", "17:43", "17:47", "17:49", "17:52", "17:56", "18:00", "18:04", "18:08", "18:11", "18:15", "18:19", "18:25"],
            [3109, "17:08", "17:14", "17:20", "17:25", "17:29", "17:32", "17:35", "17:38", "17:41", "17:45", "17:52", "17:56", "18:00", "18:02", "18:05", "18:09", "18:13", null, null, null, null, null, null],
            [3111, "17:21", "17:27", "17:33", "17:38", "17:42", "17:45", "17:48", "17:51", "17:54", "17:58", "18:05", "18:09", "18:13", "18:15", "18:18", "18:22", "18:26", "18:30", "18:34", "18:37", "18:41", "18:45", "18:51"],
            [3113, "17:34", "17:40", "17:46", "17:51", "17:55", "17:58", "18:01", "18:04", "18:07", "18:11", "18:18", "18:22", "18:26", "18:28", "18:31", "18:35", "18:39", "18:43", "18:47", "18:50", "18:54", "18:58", "19:04"],
            [3115, "17:47", "17:53", "17:59", "18:04", "18:08", "18:11", "18:14", "18:17", "18:20", "18:24", "18:31", "18:35", "18:39", "18:41", "18:44", "18:48", "18:52", null, null, null, null, null, null],
            [3117, "18:00", "18:06", "18:12", "18:17", "18:21", "18:24", "18:27", "18:30", "18:33", "18:37", "18:44", "18:48", "18:52", "18:54", "18:57", "19:01", "19:05", "19:09", "19:13", "19:16", "19:20", "19:24", "19:30"],
            [3119, "18:13", "18:19", "18:25", "18:30", "18:34", "18:37", "18:40", "18:43", "18:46", "18:50", "18:57", "19:01", "19:05", "19:07", "19:10", "19:14", "19:18", "19:22", "19:26", "19:29", "19:33", "19:37", "19:43"],
            [3121, "18:26", "18:32", "18:38", "18:43", "18:47", "18:50", "18:53", "18:56", "18:59", "19:03", "19:10", "19:14", "19:18", "19:20", "19:23", "19:27", "19:31", null, null, null, null, null, null],
            [3123, "18:39", "18:45", "18:51", "18:56", "19:00", "19:03", "19:06", "19:09", "19:12", "19:16", "19:23", "19:27", "19:31", "19:33", "19:36", "19:40", "19:44", "19:48", "19:52", "19:55", "19:59", "20:03", "20:09"],
            [3125, "18:52", "18:58", "19:04", "19:09", "19:13", "19:16", "19:19", "19:22", "19:25", "19:29", "19:36", "19:40", "19:44", "19:46", "19:49", "19:53", "19:57", "20:01", "20:05", "20:08", "20:12", "20:16", "20:22"],
            [3127, "19:05", "19:11", "19:17", "19:22", "19:26", "19:29", "19:32", "19:35", "19:38", "19:42", "19:49", "19:53", "19:57", "19:59", "20:02", "20:06", "20:10", "20:14", "20:18", "20:21", "20:25", "20:29", "20:35"],
            [3129, "19:18", "19:24", "19:30", "19:35", "19:39", "19:42", "19:45", "19:48", "19:51", "19:55", "20:02", "20:06", "20:10", "20:12", "20:15", "20:19", "20:23", null, null, null, null, null, null],
            [3131, "19:31", "19:37", "19:43", "19:48", "19:52", "19:55", "19:58", "20:01", "20:04", "20:08", "20:15", "20:19", "20:23", "20:25", "20:28", "20:32", "20:36", "20:40", "20:44", "20:47", "20:51", "20:55", "21:01"],
            [3133, "19:44", "19:50", "19:56", "20:01", "20:05", "20:08", "20:11", "20:14", "20:17", "20:21", "20:28", "20:32", "20:36", "20:38", "20:41", "20:45", "20:49", "20:53", "20:57", "21:00", "21:04", "21:08", "21:14"],
            [3135, "19:57", "20:03", "20:09", "20:14", "20:18", "20:21", "20:24", "20:27", "20:30", "20:34", "20:41", "20:45", "20:49", "20:51", "20:54", "20:58", "21:02", null, null, null, null, null, null],
            [3137, "20:10", "20:16", "20:22", "20:27", "20:31", "20:34", "20:37", "20:40", "20:43", "20:47", "20:54", "20:58", "21:02", "21:04", "21:07", "21:11", "21:15", "21:19", "21:23", "21:26", "21:30", "21:34", "21:40"],
            [3139, "20:24", "20:30", "20:36", "20:41", "20:45", "20:48", "20:51", "20:54", "20:57", "21:01", "21:08", "21:12", "21:16", "21:18", "21:21", "21:25", "21:29", "21:33", "21:37", "21:40", "21:44", "21:48", "21:54"],
            [3141, "20:42", "20:48", "20:54", "20:59", "21:03", "21:06", "21:09", "21:12", "21:15", "21:19", "21:26", "21:30", "21:34", "21:36", "21:39", "21:43", "21:47", "21:51", "21:55", "21:58", "22:02", "22:06", "22:12"],
            [3143, "20:57", "21:03", "21:09", "21:14", "21:18", "21:21", "21:24", "21:27", "21:30", "21:34", "21:41", "21:45", "21:49", "21:51", "21:54", "21:58", "22:02", "22:06", "22:10", "22:13", "22:17", "22:21", "22:27"],
            [3145, "21:12", "21:18", "21:24", "21:29", "21:33", "21:36", "21:39", "21:42", "21:45", "21:49", null, null, null, null, null, null, null, null, null, null, null, null],
            [3147, "21:27", "21:33", "21:39", "21:44", "21:48", "21:51", "21:54", "21:57", "22:00", "22:04", "22:11", "22:15", "22:19", "22:21", "22:24", "22:28", "22:32", "22:36", "22:40", "22:43", "22:47", "22:51", "22:57"],
            [3149, "21:42", "21:48", "21:54", "21:59", "22:03", "22:06", "22:09", "22:12", "22:15", "22:19", null, null, null, null, null, null, null, null, null, null, null, null],
            [3151, "21:57", "22:03", "22:09", "22:14", "22:18", "22:21", "22:24", "22:27", "22:30", "22:34", "22:41", "22:45", "22:49", "22:51", "22:54", "22:58", "23:02", "23:06", "23:10", "23:13", "23:17", "23:21", "23:27"],
            [3153, "22:25", "22:31", "22:37", "22:42", "22:46", "22:49", "22:52", "22:55", "22:58", "23:02", "23:09", "23:13", "23:17", "23:19", "23:22", "23:26", "23:30", "23:34", "23:38", "23:41", "23:45", "23:49", "23:55"],
            [3155, "22:55", "23:01", "23:07", "23:12", "23:16", "23:19", "23:22", "23:25", "23:28", "23:32", "23:39", "23:43", "23:47", "23:49", "23:52", "23:56", "00:00", "00:04", "00:08", "00:11", "00:15", "00:19", "00:25"],
            [3157, "23:15", "23:21", "23:27", "23:32", "23:36", "23:39", "23:42", "23:45", "23:48", "23:52", null, null, null, null, null, null, null, null, null, null, null, null],
            [3159, "23:45", "23:51", "23:57", "00:02", "00:06", "00:09", "00:12", "00:15", "00:18", "00:22", "00:29", "00:33", "00:37", "00:39", "00:42", "00:46", "00:50", "00:54", "00:58", "01:01", "01:05", "01:09", "01:15"],
        ];

        // Lun–Vie → Retiro (Villa Rosa = idx 0, Retiro = idx 21)
        const LV_RET = [
            [3002, null, null, null, null, null, null, null, null, "00:30", "00:35", "00:39", "00:43", "00:46", "00:50", "00:54", "00:58", "01:02", "01:05", "01:08", "01:11", "01:15", "01:22"],
            [3004, null, null, null, null, null, null, null, null, "01:30", "01:35", "01:39", "01:43", "01:46", "01:50", "01:54", "01:58", "02:02", "02:05", "02:08", "02:11", "02:15", "02:22"],
            [3006, "03:10", "03:15", "03:19", "03:23", "03:26", "03:30", "03:34", "03:38", "03:42", "03:45", "03:48", "03:51", "03:55", "04:02", "04:06", "04:09", "04:12", "04:15", "04:18", "04:22", "04:27", "04:33", "04:40"],
            [3008, null, null, null, null, null, null, null, null, "04:00", "04:04", "04:08", "04:11", "04:14", "04:17", "04:21", "04:28", "04:32", "04:35", "04:38", "04:41", "04:44", "04:48", "04:53", "04:59", "05:06"],
            [3010, "04:02", "04:07", "04:11", "04:15", "04:18", "04:22", "04:26", "04:30", "04:34", "04:37", "04:40", "04:43", "04:47", "04:54", "04:58", "05:01", "05:04", "05:07", "05:10", "05:14", "05:19", "05:25", "05:32"],
            [3012, "04:25", "04:30", "04:34", "04:38", "04:41", "04:45", "04:49", "04:53", "04:57", "05:00", "05:03", "05:06", "05:10", "05:17", "05:21", "05:24", "05:27", "05:30", "05:33", "05:37", "05:42", "05:48", "05:55"],
            [3014, null, null, null, null, null, null, null, null, "05:02", "05:06", "05:10", "05:13", "05:16", "05:19", "05:23", "05:30", "05:34", "05:37", "05:40", "05:43", "05:46", "05:50", "05:55", "06:01", "06:08"],
            [3016, "04:52", "04:57", "05:01", "05:05", "05:08", "05:12", "05:16", "05:20", "05:24", "05:27", "05:30", "05:33", "05:37", "05:44", "05:48", "05:51", "05:54", "05:57", "06:00", "06:04", "06:09", "06:15", "06:22"],
            [3018, "05:04", "05:09", "05:13", "05:17", "05:20", "05:24", "05:28", "05:32", "05:36", "05:39", "05:42", "05:45", "05:49", "05:56", "06:00", "06:03", "06:06", "06:09", "06:12", "06:16", "06:21", "06:27", "06:34"],
            [3020, null, null, null, null, null, null, null, null, "05:41", "05:45", "05:49", "05:52", "05:55", "05:58", "06:02", "06:09", "06:13", "06:16", "06:19", "06:22", "06:25", "06:29", "06:34", "06:40", "06:47"],
            [3022, "05:30", "05:35", "05:39", "05:43", "05:46", "05:50", "05:54", "05:58", "06:02", "06:05", "06:08", "06:11", "06:15", "06:22", "06:26", "06:29", "06:32", "06:35", "06:38", "06:42", "06:47", "06:53", "07:00"],
            [3024, "05:43", "05:48", "05:52", "05:56", "05:59", "06:03", "06:07", "06:11", "06:15", "06:18", "06:21", "06:24", "06:28", "06:35", "06:39", "06:42", "06:45", "06:48", "06:51", "06:55", "07:00", "07:06", "07:13"],
            [3026, "05:56", "06:01", "06:05", "06:09", "06:12", "06:16", "06:20", "06:24", "06:28", "06:31", "06:34", "06:37", "06:41", "06:48", "06:52", "06:55", "06:58", "07:01", "07:04", "07:08", "07:13", "07:19", "07:26"],
            [3028, null, null, null, null, null, null, null, null, "06:33", "06:37", "06:41", "06:44", "06:47", "06:50", "06:54", "07:01", "07:05", "07:08", "07:11", "07:14", "07:17", "07:21", "07:26", "07:32", "07:39"],
            [3030, "06:22", "06:27", "06:31", "06:35", "06:38", "06:42", "06:46", "06:50", "06:54", "06:57", "07:00", "07:03", "07:07", "07:14", "07:18", "07:21", "07:24", "07:27", "07:30", "07:34", "07:39", "07:45", "07:52"],
            [3032, "06:35", "06:40", "06:44", "06:48", "06:51", "06:55", "06:59", "07:03", "07:07", "07:10", "07:13", "07:16", "07:20", "07:27", "07:31", "07:34", "07:37", "07:40", "07:43", "07:47", "07:52", "07:58", "08:05"],
            [3034, null, null, null, null, null, null, null, null, "07:12", "07:16", "07:20", "07:23", "07:26", "07:29", "07:33", "07:40", "07:44", "07:47", "07:50", "07:53", "07:56", "08:00", "08:05", "08:11", "08:18"],
            [3036, "07:01", "07:06", "07:10", "07:14", "07:17", "07:21", "07:25", "07:29", "07:33", "07:36", "07:39", "07:42", "07:46", "07:53", "07:57", "08:00", "08:03", "08:06", "08:09", "08:13", "08:18", "08:24", "08:31"],
            [3038, "07:14", "07:19", "07:23", "07:27", "07:30", "07:34", "07:38", "07:42", "07:46", "07:49", "07:52", "07:55", "07:59", "08:06", "08:10", "08:13", "08:16", "08:19", "08:22", "08:26", "08:31", "08:37", "08:44"],
            [3040, null, null, null, null, null, null, null, null, "07:51", "07:55", "07:59", "08:02", "08:05", "08:08", "08:12", "08:19", "08:23", "08:26", "08:29", "08:32", "08:35", "08:39", "08:44", "08:50", "08:57"],
            [3042, "07:40", "07:45", "07:49", "07:53", "07:56", "08:00", "08:04", "08:08", "08:12", "08:15", "08:18", "08:21", "08:25", "08:32", "08:36", "08:39", "08:42", "08:45", "08:48", "08:52", "08:57", "09:03", "09:10"],
            [3044, "07:53", "07:58", "08:02", "08:06", "08:09", "08:13", "08:17", "08:21", "08:25", "08:28", "08:31", "08:34", "08:38", "08:45", "08:49", "08:52", "08:55", "08:58", "09:01", "09:05", "09:10", "09:16", "09:23"],
            [3046, null, null, null, null, null, null, null, null, "08:30", "08:34", "08:38", "08:41", "08:44", "08:47", "08:51", "08:58", "09:02", "09:05", "09:08", "09:11", "09:14", "09:18", "09:23", "09:29", "09:36"],
            [3048, "08:19", "08:24", "08:28", "08:32", "08:35", "08:39", "08:43", "08:47", "08:51", "08:54", "08:57", "09:00", "09:04", "09:11", "09:15", "09:18", "09:21", "09:24", "09:27", "09:31", "09:36", "09:42", "09:49"],
            [3050, "08:32", "08:37", "08:41", "08:45", "08:48", "08:52", "08:56", "09:00", "09:04", "09:07", "09:10", "09:13", "09:17", "09:24", "09:28", "09:31", "09:34", "09:37", "09:40", "09:44", "09:49", "09:55", "10:02"],
        ];

        // Sábado → Villa Rosa (subset)
        const SAB_VR = [
            [3001, "00:20", "00:26", "00:32", "00:37", "00:41", "00:44", "00:47", "00:50", "00:53", "00:57", null, null, null, null, null, null, null, null, null, null, null, null],
            [3009, "04:50", "04:56", "05:02", "05:07", "05:11", "05:14", "05:17", "05:20", "05:23", "05:27", "05:34", "05:38", "05:42", "05:44", "05:47", "05:51", "05:55", "05:59", "06:03", "06:06", "06:10", "06:14", "06:20"],
            [3011, "05:20", "05:26", "05:32", "05:37", "05:41", "05:44", "05:47", "05:50", "05:53", "05:57", "06:04", "06:08", "06:12", "06:14", "06:17", "06:21", "06:25", "06:29", "06:33", "06:36", "06:40", "06:44", "06:50"],
            [3013, "05:45", "05:51", "05:57", "06:02", "06:06", "06:09", "06:12", "06:15", "06:18", "06:22", "06:29", "06:33", "06:37", "06:39", "06:42", "06:46", "06:50", null, null, null, null, null, null],
            [3015, "06:05", "06:11", "06:17", "06:22", "06:26", "06:29", "06:32", "06:35", "06:38", "06:42", "06:49", "06:53", "06:57", "06:59", "07:02", "07:06", "07:10", "07:14", "07:18", "07:21", "07:25", "07:29", "07:35"],
            [3017, "06:25", "06:31", "06:37", "06:42", "06:46", "06:49", "06:52", "06:55", "06:58", "07:02", "07:09", "07:13", "07:17", "07:19", "07:22", "07:26", "07:30", null, null, null, null, null, null],
            [3019, "06:40", "06:46", "06:52", "06:57", "07:01", "07:04", "07:07", "07:10", "07:13", "07:17", "07:24", "07:28", "07:32", "07:34", "07:37", "07:41", "07:45", "07:49", "07:53", "07:56", "08:00", "08:04", "08:10"],
            [3021, "07:00", "07:06", "07:12", "07:17", "07:21", "07:24", "07:27", "07:30", "07:33", "07:37", "07:44", "07:48", "07:52", "07:54", "07:57", "08:01", "08:05", null, null, null, null, null, null],
            [3023, "07:15", "07:21", "07:27", "07:32", "07:36", "07:39", "07:42", "07:45", "07:48", "07:52", "07:59", "08:03", "08:07", "08:09", "08:12", "08:16", "08:20", "08:24", "08:28", "08:31", "08:35", "08:39", "08:45"],
            [3025, "07:35", "07:41", "07:47", "07:52", "07:56", "07:59", "08:02", "08:05", "08:08", "08:12", "08:19", "08:23", "08:27", "08:29", "08:32", "08:36", "08:40", null, null, null, null, null, null],
            [3027, "07:55", "08:01", "08:07", "08:12", "08:16", "08:19", "08:22", "08:25", "08:28", "08:32", "08:39", "08:43", "08:47", "08:49", "08:52", "08:56", "09:00", "09:04", "09:08", "09:11", "09:15", "09:19", "09:25"],
            [3029, "08:16", "08:22", "08:28", "08:33", "08:37", "08:40", "08:43", "08:46", "08:49", "08:53", "09:00", "09:04", "09:08", "09:10", "09:13", "09:17", "09:21", null, null, null, null, null, null],
            [3031, "08:38", "08:44", "08:50", "08:55", "08:59", "09:02", "09:05", "09:08", "09:11", "09:15", "09:22", "09:26", "09:30", "09:32", "09:35", "09:39", "09:43", "09:47", "09:51", "09:54", "09:58", "10:02", "10:08"],
            [3033, "09:00", "09:06", "09:12", "09:17", "09:21", "09:24", "09:27", "09:30", "09:33", "09:37", "09:44", "09:48", "09:52", "09:54", "09:57", "10:01", "10:05", null, null, null, null, null, null],
            [3035, "09:20", "09:26", "09:32", "09:37", "09:41", "09:44", "09:47", "09:50", "09:53", "09:57", "10:04", "10:08", "10:12", "10:14", "10:17", "10:21", "10:25", "10:29", "10:33", "10:36", "10:40", "10:44", "10:50"],
            [3037, "09:40", "09:46", "09:52", "09:57", "10:01", "10:04", "10:07", "10:10", "10:13", "10:17", "10:24", "10:28", "10:32", "10:34", "10:37", "10:41", "10:45", null, null, null, null, null, null],
            [3039, "10:00", "10:06", "10:12", "10:17", "10:21", "10:24", "10:27", "10:30", "10:33", "10:37", "10:44", "10:48", "10:52", "10:54", "10:57", "11:01", "11:05", "11:09", "11:13", "11:16", "11:20", "11:24", "11:30"],
            [3041, "10:22", "10:28", "10:34", "10:39", "10:43", "10:46", "10:49", "10:52", "10:55", "10:59", "11:06", "11:10", "11:14", "11:16", "11:19", "11:23", "11:27", null, null, null, null, null, null],
            [3043, "10:44", "10:50", "10:56", "11:01", "11:05", "11:08", "11:11", "11:14", "11:17", "11:21", "11:28", "11:32", "11:36", "11:38", "11:41", "11:45", "11:49", "11:53", "11:57", "12:00", "12:04", "12:08", "12:14"],
        ];

        // Domingo → Villa Rosa (subset)
        const DOM_VR = [
            [3001, "00:20", "00:26", "00:32", "00:37", "00:41", "00:44", "00:47", "00:50", "00:53", "00:57", null, null, null, null, null, null, null, null, null, null, null, null],
            [3011, "04:55", "05:01", "05:07", "05:12", "05:16", "05:19", "05:22", "05:25", "05:28", "05:32", "05:39", "05:43", "05:47", "05:49", "05:52", "05:56", "06:00", "06:04", "06:08", "06:11", "06:15", "06:19", "06:25"],
            [3013, "05:30", "05:36", "05:42", "05:47", "05:51", "05:54", "05:57", "06:00", "06:03", "06:07", "06:14", "06:18", "06:22", "06:24", "06:27", "06:31", "06:35", "06:39", "06:43", "06:46", "06:50", "06:54", "07:00"],
            [3015, "06:05", "06:11", "06:17", "06:22", "06:26", "06:29", "06:32", "06:35", "06:38", "06:42", "06:49", "06:53", "06:57", "06:59", "07:02", "07:06", "07:10", "07:14", "07:18", "07:21", "07:25", "07:29", "07:35"],
            [3017, "06:40", "06:46", "06:52", "06:57", "07:01", "07:04", "07:07", "07:10", "07:13", "07:17", "07:24", "07:28", "07:32", "07:34", "07:37", "07:41", "07:45", "07:49", "07:53", "07:56", "08:00", "08:04", "08:10"],
            [3019, "07:15", "07:21", "07:27", "07:32", "07:36", "07:39", "07:42", "07:45", "07:48", "07:52", "07:59", "08:03", "08:07", "08:09", "08:12", "08:16", "08:20", "08:24", "08:28", "08:31", "08:35", "08:39", "08:45"],
            [3021, "07:50", "07:56", "08:02", "08:07", "08:11", "08:14", "08:17", "08:20", "08:23", "08:27", "08:34", "08:38", "08:42", "08:44", "08:47", "08:51", "08:55", "08:59", "09:03", "09:06", "09:10", "09:14", "09:20"],
            [3023, "08:25", "08:31", "08:37", "08:42", "08:46", "08:49", "08:52", "08:55", "08:58", "09:02", "09:09", "09:13", "09:17", "09:19", "09:22", "09:26", "09:30", "09:34", "09:38", "09:41", "09:45", "09:49", "09:55"],
            [3025, "09:00", "09:06", "09:12", "09:17", "09:21", "09:24", "09:27", "09:30", "09:33", "09:37", "09:44", "09:48", "09:52", "09:54", "09:57", "10:01", "10:05", "10:09", "10:13", "10:16", "10:20", "10:24", "10:30"],
            [3027, "09:35", "09:41", "09:47", "09:52", "09:56", "09:59", "10:02", "10:05", "10:08", "10:12", "10:19", "10:23", "10:27", "10:29", "10:32", "10:36", "10:40", "10:44", "10:48", "10:51", "10:55", "10:59", "11:05"],
            [3029, "10:10", "10:16", "10:22", "10:27", "10:31", "10:34", "10:37", "10:40", "10:43", "10:47", "10:54", "10:58", "11:02", "11:04", "11:07", "11:11", "11:15", "11:19", "11:23", "11:26", "11:30", "11:34", "11:40"],
            [3031, "10:45", "10:51", "10:57", "11:02", "11:06", "11:09", "11:12", "11:15", "11:18", "11:22", "11:29", "11:33", "11:37", "11:39", "11:42", "11:46", "11:50", "11:54", "11:58", "12:01", "12:05", "12:09", "12:15"],
            [3033, "11:20", "11:26", "11:32", "11:37", "11:41", "11:44", "11:47", "11:50", "11:53", "11:57", "12:04", "12:08", "12:12", "12:14", "12:17", "12:21", "12:25", "12:29", "12:33", "12:36", "12:40", "12:44", "12:50"],
        ];

        // Retiro direction: index order is VillaRosa→Retiro in the data
        // But we display from VR side: [0]=VR...[21]=Retiro
        const SAB_RET = [
            [3002, null, null, null, null, null, null, null, null, "00:15", "00:20", "00:24", "00:28", "00:31", "00:35", "00:39", "00:43", "00:47", "00:50", "00:53", "00:56", "01:00", "01:07"],
            [3006, "03:10", "03:15", "03:19", "03:23", "03:26", "03:30", "03:34", "03:38", "03:42", "03:45", "03:48", "03:51", "03:55", "04:02", "04:06", "04:09", "04:12", "04:15", "04:18", "04:22", "04:27", "04:33", "04:40"],
            [3008, "03:40", "03:45", "03:49", "03:53", "03:56", "04:00", "04:04", "04:08", "04:12", "04:15", "04:18", "04:21", "04:25", "04:32", "04:36", "04:39", "04:42", "04:45", "04:48", "04:52", "04:57", "05:03", "05:10"],
            [3012, "04:25", "04:30", "04:34", "04:38", "04:41", "04:45", "04:49", "04:53", "04:57", "05:00", "05:03", "05:06", "05:10", "05:17", "05:21", "05:24", "05:27", "05:30", "05:33", "05:37", "05:42", "05:48", "05:55"],
            [3016, "05:00", "05:05", "05:09", "05:13", "05:16", "05:20", "05:24", "05:28", "05:32", "05:35", "05:38", "05:41", "05:45", "05:52", "05:56", "05:59", "06:02", "06:05", "06:08", "06:12", "06:17", "06:23", "06:30"],
            [3020, "05:32", "05:37", "05:41", "05:45", "05:48", "05:52", "05:56", "06:00", "06:04", "06:07", "06:10", "06:13", "06:17", "06:24", "06:28", "06:31", "06:34", "06:37", "06:40", "06:44", "06:49", "06:55", "07:02"],
            [3024, "06:04", "06:09", "06:13", "06:17", "06:20", "06:24", "06:28", "06:32", "06:36", "06:39", "06:42", "06:45", "06:49", "06:56", "07:00", "07:03", "07:06", "07:09", "07:12", "07:16", "07:21", "07:27", "07:34"],
            [3028, "06:36", "06:41", "06:45", "06:49", "06:52", "06:56", "07:00", "07:04", "07:08", "07:11", "07:14", "07:17", "07:21", "07:28", "07:32", "07:35", "07:38", "07:41", "07:44", "07:48", "07:53", "07:59", "08:06"],
            [3032, "07:08", "07:13", "07:17", "07:21", "07:24", "07:28", "07:32", "07:36", "07:40", "07:43", "07:46", "07:49", "07:53", "08:00", "08:04", "08:07", "08:10", "08:13", "08:16", "08:20", "08:25", "08:31", "08:38"],
            [3036, "07:40", "07:45", "07:49", "07:53", "07:56", "08:00", "08:04", "08:08", "08:12", "08:15", "08:18", "08:21", "08:25", "08:32", "08:36", "08:39", "08:42", "08:45", "08:48", "08:52", "08:57", "09:03", "09:10"],
            [3042, "08:28", "08:33", "08:37", "08:41", "08:44", "08:48", "08:52", "08:56", "09:00", "09:03", "09:06", "09:09", "09:13", "09:20", "09:24", "09:27", "09:30", "09:33", "09:36", "09:40", "09:45", "09:51", "09:58"],
        ];

        const DOM_RET = [
            [3002, null, null, null, null, null, null, null, null, "00:15", "00:20", "00:24", "00:28", "00:31", "00:35", "00:39", "00:43", "00:47", "00:50", "00:53", "00:56", "01:00", "01:07"],
            [3008, "03:45", "03:50", "03:54", "03:58", "04:01", "04:05", "04:09", "04:13", "04:17", "04:20", "04:23", "04:26", "04:30", "04:37", "04:41", "04:44", "04:47", "04:50", "04:53", "04:57", "05:02", "05:08", "05:15"],
            [3010, "04:20", "04:25", "04:29", "04:33", "04:36", "04:40", "04:44", "04:48", "04:52", "04:55", "04:58", "05:01", "05:05", "05:12", "05:16", "05:19", "05:22", "05:25", "05:28", "05:32", "05:37", "05:43", "05:50"],
            [3012, "04:55", "05:00", "05:04", "05:08", "05:11", "05:15", "05:19", "05:23", "05:27", "05:30", "05:33", "05:36", "05:40", "05:47", "05:51", "05:54", "05:57", "06:00", "06:03", "06:07", "06:12", "06:18", "06:25"],
            [3014, "05:30", "05:35", "05:39", "05:43", "05:46", "05:50", "05:54", "05:58", "06:02", "06:05", "06:08", "06:11", "06:15", "06:22", "06:26", "06:29", "06:32", "06:35", "06:38", "06:42", "06:47", "06:53", "07:00"],
            [3016, "06:05", "06:10", "06:14", "06:18", "06:21", "06:25", "06:29", "06:33", "06:37", "06:40", "06:43", "06:46", "06:50", "06:57", "07:01", "07:04", "07:07", "07:10", "07:13", "07:17", "07:22", "07:28", "07:35"],
            [3018, "06:40", "06:45", "06:49", "06:53", "06:56", "07:00", "07:04", "07:08", "07:12", "07:15", "07:18", "07:21", "07:25", "07:32", "07:36", "07:39", "07:42", "07:45", "07:48", "07:52", "07:57", "08:03", "08:10"],
            [3020, "07:15", "07:20", "07:24", "07:28", "07:31", "07:35", "07:39", "07:43", "07:47", "07:50", "07:53", "07:56", "08:00", "08:07", "08:11", "08:14", "08:17", "08:20", "08:23", "08:27", "08:32", "08:38", "08:45"],
            [3022, "07:50", "07:55", "07:59", "08:03", "08:06", "08:10", "08:14", "08:18", "08:22", "08:25", "08:28", "08:31", "08:35", "08:42", "08:46", "08:49", "08:52", "08:55", "08:58", "09:02", "09:07", "09:13", "09:20"],
            [3024, "08:25", "08:30", "08:34", "08:38", "08:41", "08:45", "08:49", "08:53", "08:57", "09:00", "09:03", "09:06", "09:10", "09:17", "09:21", "09:24", "09:27", "09:30", "09:33", "09:37", "09:42", "09:48", "09:55"],
            [3026, "09:00", "09:05", "09:09", "09:13", "09:16", "09:20", "09:24", "09:28", "09:32", "09:35", "09:38", "09:41", "09:45", "09:52", "09:56", "09:59", "10:02", "10:05", "10:08", "10:12", "10:17", "10:23", "10:30"],
            [3028, "09:35", "09:40", "09:44", "09:48", "09:51", "09:55", "09:59", "10:03", "10:07", "10:10", "10:13", "10:16", "10:20", "10:27", "10:31", "10:34", "10:37", "10:40", "10:43", "10:47", "10:52", "10:58", "11:05"],
            [3030, "10:10", "10:15", "10:19", "10:23", "10:26", "10:30", "10:34", "10:38", "10:42", "10:45", "10:48", "10:51", "10:55", "11:02", "11:06", "11:09", "11:12", "11:15", "11:18", "11:22", "11:27", "11:33", "11:40"],
        ];

        // ── For retiro direction, data is stored as VillaRosa[0]...Retiro[21]
        // We need to show correctly: selFrom/selTo in that order

        const DATASETS = {
            lv: { vr: LV_VR, ret: LV_RET },
            sab: { vr: SAB_VR, ret: SAB_RET },
            dom: { vr: DOM_VR, ret: DOM_RET },
        };

        // ── State ──
        let dir = 'vr';    // 'vr' or 'ret'
        let day = 'lv';

        function setDir(d) {
            dir = d;
            document.getElementById('btn-vr').className = 'pill' + (d === 'vr' ? ' active' : '');
            document.getElementById('btn-ret').className = 'pill' + (d === 'ret' ? ' active' : '');
            populateSelects();
            render();
        }

        function setDay(d) {
            day = d;
            ['lv', 'sab', 'dom'].forEach(x => {
                document.getElementById('btn-' + x).className = 'pill' + (x === d ? ' active' : '');
            });
            render();
        }

        function getDataset() {
            return (DATASETS[day] || DATASETS['lv'])[dir] || DATASETS['lv'][dir];
        }

        // For 'vr': stations left→right = STA[0..21] (Retiro→VillaRosa)
        // For 'ret': data columns are also [VillaRosa..Retiro] (idx 0=VillaRosa, idx 21=Retiro)
        // We display from left=origin for both, so for 'ret' we reverse display order
        function getDisplayStations() {
            if (dir === 'vr') return STA;
            return [...STA].reverse(); // Villa Rosa → Retiro
        }

        // Convert display index → data index
        function dispToData(dispIdx) {
            if (dir === 'vr') return dispIdx;
            return (STA.length - 1) - dispIdx;
        }

        function timeToMin(t) {
            if (!t) return null;
            const [h, m] = t.split(':').map(Number);
            return h * 60 + m;
        }

        function nowMin() {
            const n = new Date();
            return n.getHours() * 60 + n.getMinutes();
        }

        // Classify train
        function classifyTrain(row) {
            // Find last non-null time
            let lastIdx = 0;
            for (let i = 1; i < row.length; i++) if (row[i]) lastIdx = i - 1; // data col idx
            // STA[15] = Grand Bourg, STA[21] = Villa Rosa
            const reachesVR = !!row[22]; // index 22 = VillaRosa col (row[0]=trainnum, row[1..22]=stations)
            // wait, row[1] = STA[0]=Retiro, row[22]=STA[21]=VillaRosa
            if (dir === 'vr') {
                if (row[22]) return 'full'; // reaches Villa Rosa
                if (row[16]) return 'local'; // reaches Grand Bourg area (index 15+1=16)
                return 'short';
            } else {
                // for retiro dir, row[1]=VillaRosa, row[22]=Retiro
                if (row[22]) return 'full';
                if (row[7]) return 'local'; // reaches a few stops
                return 'short';
            }
        }

        function getTrainTag(row) {
            const cls = classifyTrain(row);
            if (cls === 'full') return '<span class="next-tag tag-local">Local</span>';
            if (cls === 'local') return '<span class="next-tag tag-expreso">Corto</span>';
            return '<span class="next-tag tag-directo">Parcial</span>';
        }

        // ── Selects ──
        function populateSelects() {
            const stations = getDisplayStations();
            ['selFrom', 'selTo'].forEach((id, si) => {
                const sel = document.getElementById(id);
                const prev = sel.value;
                sel.innerHTML = '<option value="">— Todas —</option>';
                stations.forEach((s, i) => {
                    const opt = document.createElement('option');
                    opt.value = i;
                    opt.textContent = s;
                    // Smart defaults
                    if (si === 0 && s === 'Cd. Ing. P. Nogués' && !prev) opt.selected = true;
                    if (si === 1 && s === (dir === 'vr' ? 'Retiro' : 'Villa Rosa') && !prev) opt.selected = true;
                    sel.appendChild(opt);
                });
                if (prev) sel.value = prev;
            });
        }

        // ── Main render ──
        function render() {
            const stations = getDisplayStations();
            const dataset = getDataset();
            const fromDisp = parseInt(document.getElementById('selFrom').value);
            const toDisp = parseInt(document.getElementById('selTo').value);
            const fromData = isNaN(fromDisp) ? null : dispToData(fromDisp);
            const toData = isNaN(toDisp) ? null : dispToData(toDisp);

            // Which display columns to show
            let colDispIdxs;
            if (!isNaN(fromDisp) && !isNaN(toDisp) && fromDisp !== toDisp) {
                const lo = Math.min(fromDisp, toDisp), hi = Math.max(fromDisp, toDisp);
                colDispIdxs = Array.from({ length: hi - lo + 1 }, (_, i) => lo + i);
            } else if (!isNaN(fromDisp)) {
                const end = Math.min(fromDisp + 6, stations.length - 1);
                colDispIdxs = Array.from({ length: end - fromDisp + 1 }, (_, i) => fromDisp + i);
            } else {
                colDispIdxs = stations.map((_, i) => i);
            }

            // Filter trains that stop at from/to
            const now = nowMin();
            let rows = dataset.filter(row => {
                if (fromData !== null && !row[fromData + 1]) return false;
                if (toData !== null && !row[toData + 1]) return false;
                return true;
            });

            // Find next train
            let nextTrain = null, nextDiff = Infinity;
            if (fromData !== null) {
                rows.forEach(row => {
                    const t = row[fromData + 1];
                    if (!t) return;
                    let m = timeToMin(t);
                    if (m < now - 120) m += 1440;
                    const diff = m - now;
                    if (diff >= 0 && diff < nextDiff) {
                        nextDiff = diff;
                        nextTrain = row;
                    }
                });
            }

            // Banner
            const banner = document.getElementById('nextBanner');
            if (nextTrain && fromData !== null && nextDiff < 180) {
                const fromT = nextTrain[fromData + 1];
                const toT = toData !== null ? nextTrain[toData + 1] : null;
                const cdText = nextDiff === 0 ? '¡Ya!' : nextDiff < 60 ? `${nextDiff} min` : `${Math.floor(nextDiff / 60)}h ${nextDiff % 60}m`;
                const fromName = stations[fromDisp];
                const toName = toData !== null ? stations[toDisp] : null;
                banner.innerHTML = `<div class="next-card">
      <div class="next-pulse"></div>
      <div class="next-info">
        <div class="next-label">Próximo tren desde ${fromName}</div>
        <div class="next-time">${fromT}${toT ? ` → ${toT}` : ''}</div>
        <div class="next-detail">
          Tren <strong>#${nextTrain[0]}</strong>
          ${toName ? `· llega a <strong>${toName}</strong> a las <strong style="color:var(--green)">${toT}</strong>` : ''}
          &nbsp; ${getTrainTag(nextTrain)}
        </div>
      </div>
      <div class="next-countdown">
        <div class="cd-num">${cdText}</div>
        <div class="cd-label">para salir</div>
      </div>
    </div>`;
            } else {
                banner.innerHTML = '';
            }

            // Title
            const dirLabel = dir === 'vr' ? '→ Villa Rosa' : '→ Retiro';
            const dayLabel = { lv: 'Lunes a Viernes', sab: 'Sábados', dom: 'Domingos y Feriados' }[day];
            document.getElementById('sectionTitle').textContent = `Partidas ${dirLabel} · ${dayLabel}`;
            document.getElementById('sectionCount').textContent = `${rows.length} trenes`;

            const grid = document.getElementById('grid');
            grid.innerHTML = '';

            if (rows.length === 0) {
                grid.innerHTML = '<div class="no-results">Sin resultados para esta selección</div>';
                return;
            }

            // Grid template
            const cols = colDispIdxs.length;
            const gridCols = `80px repeat(${cols}, 1fr)`;

            // Header
            const hdr = document.createElement('div');
            hdr.className = 'station-header';
            hdr.style.gridTemplateColumns = gridCols;

            // Tren cell
            const th0 = document.createElement('div');
            th0.className = 'sh-cell';
            th0.textContent = 'Tren';
            hdr.appendChild(th0);

            colDispIdxs.forEach((di, ci) => {
                const dataIdx = dispToData(di);
                const th = document.createElement('div');
                const colClass = `sh-col-${ci % 16}`;
                th.className = `sh-cell ${colClass}`;
                if (di === fromDisp) th.classList.add('from-col');
                if (di === toDisp) th.classList.add('to-col');
                // Wrap long names
                th.innerHTML = stations[di].replace(' ', '<br>');
                hdr.appendChild(th);
            });
            grid.appendChild(hdr);

            // Rows
            rows.forEach((row, ri) => {
                const isNext = nextTrain && row[0] === nextTrain[0];
                const fromTime = fromData !== null ? row[fromData + 1] : row.find((v, i) => i > 0 && v);
                const fromMin = fromTime ? timeToMin(fromTime) : null;
                let adjMin = fromMin;
                if (adjMin !== null && adjMin < now - 120) adjMin += 1440;
                const isPast = adjMin !== null && adjMin < now && !isNext;

                const tr = document.createElement('div');
                tr.className = `train-row ${ri % 2 === 0 ? 'even' : 'odd'}${isNext ? ' is-next' : ''}${isPast ? ' past' : ''}`;
                tr.style.gridTemplateColumns = gridCols;

                // Number + tag cell
                const td0 = document.createElement('div');
                td0.className = 'cell cell-num';
                td0.innerHTML = `<span class="train-n">#${row[0]}</span>${getTrainTag(row)}`;
                tr.appendChild(td0);

                colDispIdxs.forEach((di, ci) => {
                    const dataIdx = dispToData(di);
                    const val = row[dataIdx + 1];
                    const td = document.createElement('div');
                    const colClass = `col-${ci % 16}`;
                    td.className = `cell ${colClass}`;

                    if (!val) {
                        const sp = document.createElement('span');
                        sp.className = 'no-stop';
                        sp.textContent = '·';
                        td.appendChild(sp);
                    } else {
                        const sp = document.createElement('span');
                        sp.className = 'cell-time';
                        if (di === fromDisp) sp.classList.add('from-time');
                        else if (di === toDisp) sp.classList.add('to-time');
                        if (isNext && di === fromDisp) sp.classList.add('next-time');
                        sp.textContent = val;
                        td.appendChild(sp);
                    }
                    tr.appendChild(td);
                });

                grid.appendChild(tr);
            });
        }

        // ── Clock ──
        function tick() {
            const n = new Date();
            const pad = x => String(x).padStart(2, '0');
            document.getElementById('clock').textContent =
                `${pad(n.getHours())}:${pad(n.getMinutes())}:${pad(n.getSeconds())}`;
        }

        // ── Auto day detect ──
        function autoDay() {
            const d = new Date().getDay();
            if (d === 0) setDay('dom');
            else if (d === 6) setDay('sab');
            else setDay('lv');
        }

        // ── Init ──
        autoDay();
        populateSelects();
        render();
        tick();
        setInterval(tick, 1000);
        setInterval(render, 30000);
    </script>
</body>

</html>